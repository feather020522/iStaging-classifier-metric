
new data
train
val
test
parameters: 
batch size = 1
shuffle train = False
num workers = 6
epoch = 200
test set = self
pos threshold = 0.75
Start training, 2023-09-01 04:49:17.923243
epoch # 1 done, 2023-09-01 04:50:19.013454
epoch # 2 done, 2023-09-01 04:51:19.866247
epoch # 3 done, 2023-09-01 04:52:21.064251
epoch # 4 done, 2023-09-01 04:53:21.930998
epoch # 5 done, 2023-09-01 04:54:22.712504
epoch # 6 done, 2023-09-01 04:55:23.633614
epoch # 7 done, 2023-09-01 04:56:23.912874
epoch # 8 done, 2023-09-01 04:57:24.279569
epoch # 9 done, 2023-09-01 04:58:24.866197
epoch # 10 done, 2023-09-01 04:59:26.142603
Traceback (most recent call last):
  File "/home/tingwei/zillow_data/metric_learning.py", line 503, in <module>
    train(room_dataloader_test, epochs)
  File "/home/tingwei/zillow_data/metric_learning.py", line 484, in train
    acc_report = my_acc_calculator(room_dataloader_val, net, distance, epoch)            
  File "/home/tingwei/zillow_data/metric_learning.py", line 410, in my_acc_calculator
    outputs = model(inputs)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tingwei/zillow_data/metric_learning.py", line 344, in forward
    x = F.relu(x)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/functional.py", line 1457, in relu
    result = torch.relu(input)
RuntimeError: CUDA out of memory. Tried to allocate 142.00 MiB (GPU 0; 10.92 GiB total capacity; 10.09 GiB already allocated; 141.00 MiB free; 10.18 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

new data
train
val
test
parameters: 
batch size = 1
shuffle train = False
num workers = 6
epoch = 200
test set = self
pos threshold = 0.75
Start training, 2023-09-01 13:31:16.299373
epoch # 1 done, 2023-09-01 13:32:16.942220
epoch # 2 done, 2023-09-01 13:33:17.737643
epoch # 3 done, 2023-09-01 13:34:18.343291
epoch # 4 done, 2023-09-01 13:35:18.864655
epoch # 5 done, 2023-09-01 13:36:19.174369
epoch # 6 done, 2023-09-01 13:37:18.266281
epoch # 7 done, 2023-09-01 13:38:17.653717
epoch # 8 done, 2023-09-01 13:39:17.177605
epoch # 9 done, 2023-09-01 13:40:16.321575
epoch # 10 done, 2023-09-01 13:41:16.957639
Traceback (most recent call last):
  File "/home/tingwei/zillow_data/metric_learning.py", line 514, in <module>
    train(room_dataloader_test, epochs)
  File "/home/tingwei/zillow_data/metric_learning.py", line 495, in train
    acc_report = my_acc_calculator(room_dataloader_test2, net, distance, epoch)            
  File "/home/tingwei/zillow_data/metric_learning.py", line 421, in my_acc_calculator
    outputs = model(inputs)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tingwei/zillow_data/metric_learning.py", line 354, in forward
    x = self.conv1(x)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 156.00 MiB (GPU 0; 10.92 GiB total capacity; 10.14 GiB already allocated; 95.00 MiB free; 10.22 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

new data
train
val
test
parameters: 
batch size = 1
shuffle train = False
num workers = 6
epoch = 200
test set = self
pos threshold = 0.75
Start training, 2023-09-01 13:54:14.110540
epoch # 1 done, 2023-09-01 13:55:15.482983
epoch # 2 done, 2023-09-01 13:56:16.285695
epoch # 3 done, 2023-09-01 13:57:17.033287
epoch # 4 done, 2023-09-01 13:58:17.554066
epoch # 5 done, 2023-09-01 13:59:17.957974
epoch # 6 done, 2023-09-01 14:00:18.685601
epoch # 7 done, 2023-09-01 14:01:20.013506
epoch # 8 done, 2023-09-01 14:02:20.958005
epoch # 9 done, 2023-09-01 14:03:21.625617
epoch # 10 done, 2023-09-01 14:04:22.890362
Traceback (most recent call last):
  File "/home/tingwei/zillow_data/metric_learning.py", line 495, in <module>
    acc_report = my_acc_calculator(room_dataloader_test2, net, distance, epoch)            
  File "/home/tingwei/zillow_data/metric_learning.py", line 421, in my_acc_calculator
    outputs = model(inputs)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tingwei/zillow_data/metric_learning.py", line 354, in forward
    x = self.conv1(x)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 457, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/tingwei/miniconda3/envs/Zillow/lib/python3.10/site-packages/torch/nn/modules/conv.py", line 453, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: CUDA out of memory. Tried to allocate 156.00 MiB (GPU 0; 10.92 GiB total capacity; 10.14 GiB already allocated; 95.00 MiB free; 10.22 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

new data
train
val
test
parameters: 
batch size = 1
shuffle train = False
num workers = 6
epoch = 200
test set = self
pos threshold = 0.75
Start training, 2023-09-01 14:13:23.025507
epoch # 1 done, 2023-09-01 14:14:22.573786
epoch # 2 done, 2023-09-01 14:15:23.160964
epoch # 3 done, 2023-09-01 14:16:24.448818
epoch # 4 done, 2023-09-01 14:17:25.226310
epoch # 5 done, 2023-09-01 14:18:25.948830
epoch # 6 done, 2023-09-01 14:19:26.821277
epoch # 7 done, 2023-09-01 14:20:27.271305
epoch # 8 done, 2023-09-01 14:21:28.160266
epoch # 9 done, 2023-09-01 14:22:28.694126
epoch # 10 done, 2023-09-01 14:23:29.478368
               precision    recall  f1-score   support

negative pair       0.99      0.57      0.72    417440
positive pair       0.11      0.94      0.20     24770

     accuracy                           0.59    442210
    macro avg       0.55      0.75      0.46    442210
 weighted avg       0.94      0.59      0.69    442210

val # 10 done, 2023-09-01 14:24:51.173169
epoch # 11 done, 2023-09-01 14:25:51.779493
epoch # 12 done, 2023-09-01 14:26:50.844959
epoch # 13 done, 2023-09-01 14:27:51.507455
epoch # 14 done, 2023-09-01 14:28:50.265424
epoch # 15 done, 2023-09-01 14:29:49.538454
epoch # 16 done, 2023-09-01 14:30:49.371422
epoch # 17 done, 2023-09-01 14:31:48.410024
epoch # 18 done, 2023-09-01 14:32:47.261282
epoch # 19 done, 2023-09-01 14:33:46.220659
epoch # 20 done, 2023-09-01 14:34:46.643965
               precision    recall  f1-score   support

negative pair       0.99      0.76      0.86    417440
positive pair       0.18      0.88      0.29     24770

     accuracy                           0.76    442210
    macro avg       0.58      0.82      0.58    442210
 weighted avg       0.94      0.76      0.83    442210

val # 20 done, 2023-09-01 14:36:08.358649
epoch # 21 done, 2023-09-01 14:37:09.421022
epoch # 22 done, 2023-09-01 14:38:10.198979
epoch # 23 done, 2023-09-01 14:39:09.148466
epoch # 24 done, 2023-09-01 14:40:09.726277
epoch # 25 done, 2023-09-01 14:41:08.907286
epoch # 26 done, 2023-09-01 14:42:08.824729
epoch # 27 done, 2023-09-01 14:43:08.971292
epoch # 28 done, 2023-09-01 14:44:09.793546
epoch # 29 done, 2023-09-01 14:45:10.532708
epoch # 30 done, 2023-09-01 14:46:11.078003
               precision    recall  f1-score   support

negative pair       0.99      0.84      0.91    417440
positive pair       0.24      0.83      0.37     24770

     accuracy                           0.84    442210
    macro avg       0.61      0.84      0.64    442210
 weighted avg       0.95      0.84      0.88    442210

val # 30 done, 2023-09-01 14:47:32.809801
epoch # 31 done, 2023-09-01 14:48:33.785661
epoch # 32 done, 2023-09-01 14:49:34.097751
epoch # 33 done, 2023-09-01 14:50:34.823285
epoch # 34 done, 2023-09-01 14:51:33.826175
epoch # 35 done, 2023-09-01 14:52:34.172608
epoch # 36 done, 2023-09-01 14:53:34.919606
epoch # 37 done, 2023-09-01 14:54:34.249796
epoch # 38 done, 2023-09-01 14:55:33.724720
epoch # 39 done, 2023-09-01 14:56:34.409240
epoch # 40 done, 2023-09-01 14:57:35.101405
               precision    recall  f1-score   support

negative pair       0.99      0.89      0.94    417440
positive pair       0.31      0.81      0.44     24770

     accuracy                           0.89    442210
    macro avg       0.65      0.85      0.69    442210
 weighted avg       0.95      0.89      0.91    442210

val # 40 done, 2023-09-01 14:58:56.375213
epoch # 41 done, 2023-09-01 14:59:56.865171
epoch # 42 done, 2023-09-01 15:00:57.517170
epoch # 43 done, 2023-09-01 15:01:58.810864
epoch # 44 done, 2023-09-01 15:02:57.846522
epoch # 45 done, 2023-09-01 15:03:56.905040
epoch # 46 done, 2023-09-01 15:04:55.766017
epoch # 47 done, 2023-09-01 15:05:54.785693
epoch # 48 done, 2023-09-01 15:06:55.241498
epoch # 49 done, 2023-09-01 15:07:54.620361
epoch # 50 done, 2023-09-01 15:08:53.830287
               precision    recall  f1-score   support

negative pair       0.99      0.91      0.95    417440
positive pair       0.35      0.79      0.49     24770

     accuracy                           0.91    442210
    macro avg       0.67      0.85      0.72    442210
 weighted avg       0.95      0.91      0.92    442210

val # 50 done, 2023-09-01 15:10:15.596368
epoch # 51 done, 2023-09-01 15:11:16.332334
epoch # 52 done, 2023-09-01 15:12:15.608428
epoch # 53 done, 2023-09-01 15:13:15.229217
epoch # 54 done, 2023-09-01 15:14:15.961721
epoch # 55 done, 2023-09-01 15:15:15.102455
epoch # 56 done, 2023-09-01 15:16:15.747213
epoch # 57 done, 2023-09-01 15:17:14.646657
epoch # 58 done, 2023-09-01 15:18:15.384222
epoch # 59 done, 2023-09-01 15:19:16.009283
epoch # 60 done, 2023-09-01 15:20:16.779477
               precision    recall  f1-score   support

negative pair       0.99      0.92      0.95    417440
positive pair       0.37      0.80      0.51     24770

     accuracy                           0.91    442210
    macro avg       0.68      0.86      0.73    442210
 weighted avg       0.95      0.91      0.93    442210

val # 60 done, 2023-09-01 15:21:38.489818
epoch # 61 done, 2023-09-01 15:22:39.231044
epoch # 62 done, 2023-09-01 15:23:38.318751
epoch # 63 done, 2023-09-01 15:24:37.648376
epoch # 64 done, 2023-09-01 15:25:37.031499
epoch # 65 done, 2023-09-01 15:26:36.270688
epoch # 66 done, 2023-09-01 15:27:35.182233
epoch # 67 done, 2023-09-01 15:28:34.240751
epoch # 68 done, 2023-09-01 15:29:33.270395
epoch # 69 done, 2023-09-01 15:30:32.608844
epoch # 70 done, 2023-09-01 15:31:31.877283
               precision    recall  f1-score   support

negative pair       0.99      0.93      0.96    417440
positive pair       0.38      0.77      0.51     24770

     accuracy                           0.92    442210
    macro avg       0.68      0.85      0.73    442210
 weighted avg       0.95      0.92      0.93    442210

val # 70 done, 2023-09-01 15:32:54.338438
epoch # 71 done, 2023-09-01 15:33:55.128761
epoch # 72 done, 2023-09-01 15:34:54.388574
epoch # 73 done, 2023-09-01 15:35:53.258377
epoch # 74 done, 2023-09-01 15:36:52.724822
epoch # 75 done, 2023-09-01 15:37:53.663607
epoch # 76 done, 2023-09-01 15:38:52.836550
epoch # 77 done, 2023-09-01 15:39:52.194405
epoch # 78 done, 2023-09-01 15:40:51.240222
epoch # 79 done, 2023-09-01 15:41:52.184643
epoch # 80 done, 2023-09-01 15:42:51.053320
               precision    recall  f1-score   support

negative pair       0.98      0.95      0.97    417440
positive pair       0.47      0.75      0.58     24770

     accuracy                           0.94    442210
    macro avg       0.73      0.85      0.77    442210
 weighted avg       0.96      0.94      0.94    442210

val # 80 done, 2023-09-01 15:44:13.196524
epoch # 81 done, 2023-09-01 15:45:13.861861
epoch # 82 done, 2023-09-01 15:46:12.508953
epoch # 83 done, 2023-09-01 15:47:13.028465
epoch # 84 done, 2023-09-01 15:48:12.104725
epoch # 85 done, 2023-09-01 15:49:10.934375
epoch # 86 done, 2023-09-01 15:50:10.212749
epoch # 87 done, 2023-09-01 15:51:10.388975
epoch # 88 done, 2023-09-01 15:52:11.069936
epoch # 89 done, 2023-09-01 15:53:11.523206
epoch # 90 done, 2023-09-01 15:54:12.302472
               precision    recall  f1-score   support

negative pair       0.99      0.94      0.96    417440
positive pair       0.45      0.78      0.57     24770

     accuracy                           0.93    442210
    macro avg       0.72      0.86      0.77    442210
 weighted avg       0.96      0.93      0.94    442210

val # 90 done, 2023-09-01 15:55:33.968675
epoch # 91 done, 2023-09-01 15:56:35.267624
epoch # 92 done, 2023-09-01 15:57:35.636482
epoch # 93 done, 2023-09-01 15:58:34.621331
epoch # 94 done, 2023-09-01 15:59:35.229508
epoch # 95 done, 2023-09-01 16:00:34.248971
epoch # 96 done, 2023-09-01 16:01:33.170719
epoch # 97 done, 2023-09-01 16:02:33.954874
epoch # 98 done, 2023-09-01 16:03:33.030784
epoch # 99 done, 2023-09-01 16:04:33.305535
epoch # 100 done, 2023-09-01 16:05:32.044850
               precision    recall  f1-score   support

negative pair       0.98      0.96      0.97    417440
positive pair       0.53      0.74      0.62     24770

     accuracy                           0.95    442210
    macro avg       0.76      0.85      0.79    442210
 weighted avg       0.96      0.95      0.95    442210

val # 100 done, 2023-09-01 16:06:53.658663
epoch # 101 done, 2023-09-01 16:07:54.570318
epoch # 102 done, 2023-09-01 16:08:53.814891
epoch # 103 done, 2023-09-01 16:09:54.513525
epoch # 104 done, 2023-09-01 16:10:53.518481
epoch # 105 done, 2023-09-01 16:11:54.085846
epoch # 106 done, 2023-09-01 16:12:52.974297
epoch # 107 done, 2023-09-01 16:13:52.109417
epoch # 108 done, 2023-09-01 16:14:51.262929
epoch # 109 done, 2023-09-01 16:15:50.523368
epoch # 110 done, 2023-09-01 16:16:51.959572
               precision    recall  f1-score   support

negative pair       0.98      0.96      0.97    417440
positive pair       0.53      0.74      0.62     24770

     accuracy                           0.95    442210
    macro avg       0.76      0.85      0.80    442210
 weighted avg       0.96      0.95      0.95    442210

val # 110 done, 2023-09-01 16:18:13.608832
epoch # 111 done, 2023-09-01 16:19:14.439325
epoch # 112 done, 2023-09-01 16:20:13.374234
epoch # 113 done, 2023-09-01 16:21:13.770459
epoch # 114 done, 2023-09-01 16:22:12.796847
epoch # 115 done, 2023-09-01 16:23:12.033533
epoch # 116 done, 2023-09-01 16:24:11.580778
epoch # 117 done, 2023-09-01 16:25:10.933292
epoch # 118 done, 2023-09-01 16:26:10.390863
epoch # 119 done, 2023-09-01 16:27:10.617600
epoch # 120 done, 2023-09-01 16:28:10.539198
               precision    recall  f1-score   support

negative pair       0.99      0.96      0.97    417440
positive pair       0.53      0.76      0.63     24770

     accuracy                           0.95    442210
    macro avg       0.76      0.86      0.80    442210
 weighted avg       0.96      0.95      0.95    442210

val # 120 done, 2023-09-01 16:29:33.093433
epoch # 121 done, 2023-09-01 16:30:33.838043
epoch # 122 done, 2023-09-01 16:31:34.201525
epoch # 123 done, 2023-09-01 16:32:33.468394
epoch # 124 done, 2023-09-01 16:33:34.034673
epoch # 125 done, 2023-09-01 16:34:35.210063
epoch # 126 done, 2023-09-01 16:35:35.750713
epoch # 127 done, 2023-09-01 16:36:34.882512
epoch # 128 done, 2023-09-01 16:37:35.649662
epoch # 129 done, 2023-09-01 16:38:36.277114
epoch # 130 done, 2023-09-01 16:39:35.242500
               precision    recall  f1-score   support

negative pair       0.98      0.97      0.98    417440
positive pair       0.59      0.74      0.66     24770

     accuracy                           0.96    442210
    macro avg       0.79      0.85      0.82    442210
 weighted avg       0.96      0.96      0.96    442210

val # 130 done, 2023-09-01 16:40:56.850493
epoch # 131 done, 2023-09-01 16:41:57.821081
epoch # 132 done, 2023-09-01 16:42:56.762188
epoch # 133 done, 2023-09-01 16:43:55.692478
epoch # 134 done, 2023-09-01 16:44:56.096563
epoch # 135 done, 2023-09-01 16:45:56.437502
epoch # 136 done, 2023-09-01 16:46:57.372442
epoch # 137 done, 2023-09-01 16:47:56.105586
epoch # 138 done, 2023-09-01 16:48:56.812849
epoch # 139 done, 2023-09-01 16:49:58.010264
epoch # 140 done, 2023-09-01 16:50:59.059849
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.65      0.72      0.68     24770

     accuracy                           0.96    442210
    macro avg       0.82      0.85      0.83    442210
 weighted avg       0.96      0.96      0.96    442210

val # 140 done, 2023-09-01 16:52:20.503520
epoch # 141 done, 2023-09-01 16:53:21.184938
epoch # 142 done, 2023-09-01 16:54:22.067638
epoch # 143 done, 2023-09-01 16:55:22.560776
epoch # 144 done, 2023-09-01 16:56:21.893346
epoch # 145 done, 2023-09-01 16:57:21.197646
epoch # 146 done, 2023-09-01 16:58:21.702632
epoch # 147 done, 2023-09-01 16:59:20.803939
epoch # 148 done, 2023-09-01 17:00:21.775397
epoch # 149 done, 2023-09-01 17:01:22.494652
epoch # 150 done, 2023-09-01 17:02:22.978274
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.67      0.71      0.69     24770

     accuracy                           0.96    442210
    macro avg       0.83      0.85      0.84    442210
 weighted avg       0.97      0.96      0.96    442210

val # 150 done, 2023-09-01 17:03:45.995928
epoch # 151 done, 2023-09-01 17:04:46.668816
epoch # 152 done, 2023-09-01 17:05:47.338404
epoch # 153 done, 2023-09-01 17:06:47.080370
epoch # 154 done, 2023-09-01 17:07:47.571058
epoch # 155 done, 2023-09-01 17:08:48.118201
epoch # 156 done, 2023-09-01 17:09:48.551286
epoch # 157 done, 2023-09-01 17:10:47.729483
epoch # 158 done, 2023-09-01 17:11:46.745278
epoch # 159 done, 2023-09-01 17:12:47.278587
epoch # 160 done, 2023-09-01 17:13:46.457944
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.70      0.71      0.70     24770

     accuracy                           0.97    442210
    macro avg       0.84      0.85      0.84    442210
 weighted avg       0.97      0.97      0.97    442210

val # 160 done, 2023-09-01 17:15:09.136302
epoch # 161 done, 2023-09-01 17:16:09.398280
epoch # 162 done, 2023-09-01 17:17:09.918449
epoch # 163 done, 2023-09-01 17:18:09.052431
epoch # 164 done, 2023-09-01 17:19:08.298125
epoch # 165 done, 2023-09-01 17:20:08.688410
epoch # 166 done, 2023-09-01 17:21:07.648952
epoch # 167 done, 2023-09-01 17:22:06.442904
epoch # 168 done, 2023-09-01 17:23:06.079493
epoch # 169 done, 2023-09-01 17:24:05.428665
epoch # 170 done, 2023-09-01 17:25:04.258998
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.69      0.73      0.71     24770

     accuracy                           0.97    442210
    macro avg       0.84      0.85      0.84    442210
 weighted avg       0.97      0.97      0.97    442210

val # 170 done, 2023-09-01 17:26:27.090164
epoch # 171 done, 2023-09-01 17:27:27.617810
epoch # 172 done, 2023-09-01 17:28:27.865651
epoch # 173 done, 2023-09-01 17:29:28.234950
epoch # 174 done, 2023-09-01 17:30:29.059659
epoch # 175 done, 2023-09-01 17:31:29.466279
epoch # 176 done, 2023-09-01 17:32:30.174101
epoch # 177 done, 2023-09-01 17:33:29.433936
epoch # 178 done, 2023-09-01 17:34:28.270047
epoch # 179 done, 2023-09-01 17:35:29.333159
epoch # 180 done, 2023-09-01 17:36:29.208369
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.70      0.71      0.71     24770

     accuracy                           0.97    442210
    macro avg       0.84      0.85      0.85    442210
 weighted avg       0.97      0.97      0.97    442210

val # 180 done, 2023-09-01 17:37:51.734244
epoch # 181 done, 2023-09-01 17:38:52.281378
epoch # 182 done, 2023-09-01 17:39:53.042483
epoch # 183 done, 2023-09-01 17:40:52.099130
epoch # 184 done, 2023-09-01 17:41:51.263353
epoch # 185 done, 2023-09-01 17:42:51.750685
epoch # 186 done, 2023-09-01 17:43:51.021995
epoch # 187 done, 2023-09-01 17:44:50.447237
epoch # 188 done, 2023-09-01 17:45:51.063068
epoch # 189 done, 2023-09-01 17:46:52.184347
epoch # 190 done, 2023-09-01 17:47:53.141037
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.71      0.72      0.71     24770

     accuracy                           0.97    442210
    macro avg       0.85      0.85      0.85    442210
 weighted avg       0.97      0.97      0.97    442210

val # 190 done, 2023-09-01 17:49:14.998785
epoch # 191 done, 2023-09-01 17:50:16.153325
epoch # 192 done, 2023-09-01 17:51:17.055362
epoch # 193 done, 2023-09-01 17:52:17.812783
epoch # 194 done, 2023-09-01 17:53:18.849674
epoch # 195 done, 2023-09-01 17:54:20.083409
epoch # 196 done, 2023-09-01 17:55:18.850378
epoch # 197 done, 2023-09-01 17:56:17.888791
epoch # 198 done, 2023-09-01 17:57:16.822565
epoch # 199 done, 2023-09-01 17:58:15.864173
epoch # 200 done, 2023-09-01 17:59:16.478959
               precision    recall  f1-score   support

negative pair       0.98      0.98      0.98    417440
positive pair       0.70      0.71      0.71     24770

     accuracy                           0.97    442210
    macro avg       0.84      0.85      0.84    442210
 weighted avg       0.97      0.97      0.97    442210

val # 200 done, 2023-09-01 18:00:38.891060
               precision    recall  f1-score   support

negative pair       0.98      0.97      0.98    410388
positive pair       0.60      0.66      0.63     24322

     accuracy                           0.96    434710
    macro avg       0.79      0.82      0.80    434710
 weighted avg       0.96      0.96      0.96    434710

Last val: test done, 2023-09-01 18:02:00.336702
Finished Training

new data
train
val
test
Traceback (most recent call last):
  File "/home/tingwei/zillow_data/metric_learning.py", line 274, in <module>
    test_panos, test_buildings, test_pano_count = PanoLabelGetter(houses_data, partition_data, "test", need_to_cut = True)
  File "/home/tingwei/zillow_data/metric_learning.py", line 180, in PanoLabelGetter
    while max_label - min_label + 1 >= 2 * batch_count:
TypeError: unsupported operand type(s) for -: 'list' and 'list'
